<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="送货单二维码生成器 - 批量生成送货单和送货单明细二维码">
    <title>送货单 QR Code 生成器</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="enhancements.css">
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <script src="qrcode.min.js"></script>
    <!-- 本地离线库 -->
    <script src="libs/xlsx.full.min.js"></script>
    <script src="libs/jszip.min.js"></script>
    <script src="libs/FileSaver.min.js"></script>
</head>

<body>
    <div class="container">
        <header class="header">
            <div class="logo">
                <svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="3" y="3" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2" />
                    <rect x="14" y="3" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2" />
                    <rect x="3" y="14" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2" />
                    <rect x="14" y="14" width="3" height="3" fill="currentColor" />
                    <rect x="18" y="14" width="3" height="3" fill="currentColor" />
                    <rect x="14" y="18" width="3" height="3" fill="currentColor" />
                    <rect x="18" y="18" width="3" height="3" fill="currentColor" />
                </svg>
            </div>
            <h1>送货单 QR Code 生成器</h1>
            <p class="subtitle">Delivery Note QR Code Generator - 支持批量生成</p>
            <button id="installAppBtn" class="install-app-btn" style="display: none;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"></path>
                    <polyline points="7 10 12 15 17 10"></polyline>
                    <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
                安装到桌面
            </button>
        </header>

        <!-- 使用指南区域 (可折叠) -->
        <section class="guide-section">
            <div class="guide-card" id="guideCard">
                <div class="guide-header" onclick="document.getElementById('guideCard').classList.toggle('expanded')">
                    <div class="guide-title-row">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                            <path d="M12 16v-4M12 8h.01" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" />
                        </svg>
                        <h3>使用流程与操作指南 <span class="header-hint">（点击可展开说明）</span></h3>
                    </div>
                    <svg class="guide-toggle-icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
                        <path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round" />
                    </svg>
                </div>

                <div class="guide-content">
                    <div class="guide-grid">
                        <!-- 方式 1 -->
                        <div class="guide-col">
                            <h4 class="guide-col-title">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                                    <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6z"
                                        stroke="currentColor" stroke-width="2" />
                                    <path d="M14 2v6h6" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                                </svg>
                                方式 1：模板导入 (推荐)
                            </h4>
                            <p class="guide-text">
                                最适合大批量数据。点击下面对应模块的 <b>"下载模板"</b>，在 Excel 中填好数据后，点击 <b>"导入数据"</b> 即可一键填充。
                            </p>
                        </div>

                        <!-- 方式 2 -->
                        <div class="guide-col">
                            <h4 class="guide-col-title">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                                    <path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"
                                        stroke="currentColor" stroke-width="2" />
                                    <rect x="8" y="2" width="8" height="4" rx="1" stroke="currentColor"
                                        stroke-width="2" />
                                </svg>
                                方式 2：智能粘贴
                            </h4>
                            <p class="guide-text">
                                在 Excel 中选中数据区域并复制，然后直接粘贴到页面的 <b>"快速粘贴"</b> 输入框中，点击 <b>"解析并填充"</b>。支持自动识别 Tab 和空格分隔。
                            </p>
                        </div>

                        <!-- 方式 3 -->
                        <div class="guide-col">
                            <h4 class="guide-col-title">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                                    <path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"
                                        stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round" />
                                    <path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"
                                        stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round" />
                                </svg>
                                方式 3：手动输入
                            </h4>
                            <p class="guide-text">
                                直接在下方输入框中输入或修改数据。点击 <b>"添加行"</b> 可新增空行。支持对单行进行复制或删除操作。
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <main class="main-content">
            <!-- 送货单 QR Code 区域 -->
            <section class="qr-section dn-section">
                <div class="section-header">
                    <div class="section-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                            <rect x="9" y="3" width="6" height="4" rx="1" stroke="currentColor" stroke-width="2" />
                            <path d="M9 12h6M9 16h4" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                    </div>
                    <div>
                        <h2>送货单表头 QR Code</h2>
                        <p>DN QR Code - 包含3种信息（批量输入）</p>
                    </div>

                    <div class="header-actions">
                        <button class="template-btn header-btn" id="downloadDnTemplate">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6z"
                                    stroke="currentColor" stroke-width="2" />
                                <path d="M14 2v6h6" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                            </svg>
                            下载模板
                        </button>
                        <button class="template-btn header-btn"
                            onclick="document.getElementById('importDnFile').click()">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12"
                                    stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" />
                            </svg>
                            导入数据
                        </button>
                        <input type="file" id="importDnFile" accept=".xlsx,.xls,.csv" style="display: none;">
                    </div>
                </div>

                <!-- 快速粘贴区域 -->
                <div class="paste-area-container">
                    <div class="paste-area-header">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"
                                stroke="currentColor" stroke-width="2" />
                            <rect x="8" y="2" width="8" height="4" rx="1" stroke="currentColor" stroke-width="2" />
                        </svg>
                        <span>快速粘贴（从Excel复制后粘贴到此处）</span>
                    </div>
                    <textarea class="paste-area" id="dnPasteArea"
                        placeholder="从Excel表格中复制数据，粘贴到这里...&#10;支持多行粘贴，数据之间用Tab或者空格分隔，不同行以回车符间隔" rows="3"></textarea>
                    <button class="paste-parse-btn" id="dnParsePaste">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M5 12h14M12 5l7 7-7 7" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                        解析并填充
                    </button>
                </div>

                <div class="table-container">
                    <table class="data-table" id="dnTable">
                        <thead>
                            <tr>
                                <th class="row-num">#</th>
                                <th>DN No. <span class="th-cn">送货单号</span></th>
                                <th>Vendor ID <span class="th-cn">供应商编号</span></th>
                                <th>PO No. <span class="th-cn">采购订单</span></th>
                                <th class="qr-col">QR Code</th>
                                <th class="action-col">操作</th>
                            </tr>
                        </thead>
                        <tbody id="dnTableBody">
                            <tr>
                                <td class="row-num">1</td>
                                <td><input type="text" class="table-input dn-no" placeholder="如DN20250418001"></td>
                                <td><input type="text" class="table-input vendor-id" placeholder="如7016"></td>
                                <td><input type="text" class="table-input po-no" placeholder="如263275"></td>
                                <td class="qr-cell"><canvas class="qr-canvas"></canvas></td>
                                <td class="action-cell">
                                    <button class="btn-icon copy-row" title="复制" disabled>
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                            <rect x="9" y="9" width="13" height="13" rx="2" stroke="currentColor"
                                                stroke-width="2" />
                                            <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"
                                                stroke="currentColor" stroke-width="2" />
                                        </svg>
                                    </button>
                                    <button class="btn-icon download-row" title="下载" disabled>
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                            <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3"
                                                stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                                stroke-linejoin="round" />
                                        </svg>
                                    </button>
                                    <button class="btn-icon delete-row" title="删除行">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2"
                                                stroke-linecap="round" />
                                        </svg>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="table-actions">
                    <button class="add-row-btn" id="addDnRow">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        添加行
                    </button>
                    <button class="generate-btn" id="generateAllDn">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <rect x="3" y="3" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2" />
                            <rect x="14" y="3" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2" />
                            <rect x="3" y="14" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2" />
                            <path d="M14 14h7v7h-7z" stroke="currentColor" stroke-width="2" />
                        </svg>
                        批量生成
                    </button>
                    <button class="download-all-btn" id="downloadAllDn" disabled>
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                        全部下载
                    </button>
                    <button class="download-all-btn" id="copyAllDn" disabled>
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <rect x="9" y="9" width="13" height="13" rx="2" stroke="currentColor" stroke-width="2" />
                            <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1" stroke="currentColor"
                                stroke-width="2" />
                        </svg>
                        复制所有二维码
                    </button>
                    <button class="download-all-btn" id="exportReportDn" disabled>
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6z" stroke="currentColor"
                                stroke-width="2" />
                            <path d="M14 2v6h6" stroke="currentColor" stroke-width="2" />
                            <path d="M8 13h8M8 17h8M8 9h2" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" />
                        </svg>
                        导出数据报表
                    </button>
                    <button class="add-row-btn danger-outline" id="clearAllDn">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6M8 6V4a2 2 0 012-2h4a2 2 0 012 2v2"
                                stroke="currentColor" stroke-width="2" />
                        </svg>
                        清空数据
                    </button>
                </div>
            </section>

            <!-- 送货单明细 QR Code 区域 -->
            <section class="qr-section detail-section">
                <div class="section-header">
                    <div class="section-icon detail-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6z" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                            <path d="M14 2v6h6M16 13H8M16 17H8M10 9H8" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                    </div>
                    <div>
                        <h2>送货单明细 QR Code</h2>
                        <p>DN Detail QR Code - 包含5种信息（批量输入）</p>
                    </div>

                    <div class="header-actions">
                        <button class="template-btn detail-template header-btn" id="downloadDetailTemplate">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6z"
                                    stroke="currentColor" stroke-width="2" />
                                <path d="M14 2v6h6" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                            </svg>
                            下载模板
                        </button>
                        <button class="template-btn detail-template header-btn"
                            onclick="document.getElementById('importDetailFile').click()">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12"
                                    stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" />
                            </svg>
                            导入数据
                        </button>
                        <input type="file" id="importDetailFile" accept=".xlsx,.xls,.csv" style="display: none;">
                    </div>
                </div>

                <!-- 快速粘贴区域 -->
                <div class="paste-area-container">
                    <div class="paste-area-header">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"
                                stroke="currentColor" stroke-width="2" />
                            <rect x="8" y="2" width="8" height="4" rx="1" stroke="currentColor" stroke-width="2" />
                        </svg>
                        <span>快速粘贴（从Excel复制后粘贴到此处）</span>
                    </div>
                    <textarea class="paste-area" id="detailPasteArea"
                        placeholder="从Excel表格中复制数据，粘贴到这里...&#10;支持多行粘贴，数据之间用Tab或者空格分隔，不同行以回车符间隔" rows="3"></textarea>
                    <button class="paste-parse-btn detail-paste-btn" id="detailParsePaste">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M5 12h14M12 5l7 7-7 7" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                        解析并填充
                    </button>
                </div>

                <div class="table-container">
                    <table class="data-table detail-table" id="detailTable">
                        <thead>
                            <tr>
                                <th class="row-num">#</th>
                                <th>Full PO No. <span class="th-cn">完整采购单号</span></th>
                                <th>Qty <span class="th-cn">数量</span></th>
                                <th>Unit <span class="th-cn">单位</span></th>
                                <th>Unique ID <span class="th-cn">流水号</span></th>
                                <th>PN <span class="th-cn">零件编号</span></th>
                                <th class="qr-col">QR Code</th>
                                <th class="action-col">操作</th>
                            </tr>
                        </thead>
                        <tbody id="detailTableBody">
                            <tr>
                                <td class="row-num">1</td>
                                <td><input type="text" class="table-input full-po-no" placeholder="如263275-1-1"></td>
                                <td><input type="text" class="table-input qty" placeholder="如3"></td>
                                <td><input type="text" class="table-input unit" placeholder="如PC"></td>
                                <td><input type="text" class="table-input unique-id" placeholder="如250418003"></td>
                                <td><input type="text" class="table-input pn" placeholder="如MT4571-01-001"></td>
                                <td class="qr-cell"><canvas class="qr-canvas"></canvas></td>
                                <td class="action-cell">
                                    <button class="btn-icon copy-row" title="复制" disabled>
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                            <rect x="9" y="9" width="13" height="13" rx="2" stroke="currentColor"
                                                stroke-width="2" />
                                            <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"
                                                stroke="currentColor" stroke-width="2" />
                                        </svg>
                                    </button>
                                    <button class="btn-icon download-row" title="下载" disabled>
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                            <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3"
                                                stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                                stroke-linejoin="round" />
                                        </svg>
                                    </button>
                                    <button class="btn-icon delete-row" title="删除行">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2"
                                                stroke-linecap="round" />
                                        </svg>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="table-actions">
                    <button class="add-row-btn detail-add" id="addDetailRow">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        添加行
                    </button>
                    <button class="generate-btn detail-btn" id="generateAllDetail">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <rect x="3" y="3" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2" />
                            <rect x="14" y="3" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2" />
                            <rect x="3" y="14" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2" />
                            <path d="M14 14h7v7h-7z" stroke="currentColor" stroke-width="2" />
                        </svg>
                        批量生成
                    </button>
                    <button class="download-all-btn detail-download-all" id="downloadAllDetail" disabled>
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                        全部下载
                    </button>
                    <button class="download-all-btn detail-download-all" id="copyAllDetail" disabled>
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <rect x="9" y="9" width="13" height="13" rx="2" stroke="currentColor" stroke-width="2" />
                            <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1" stroke="currentColor"
                                stroke-width="2" />
                        </svg>
                        复制所有二维码
                    </button>
                    <button class="download-all-btn detail-download-all" id="exportReportDetail" disabled>
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6z" stroke="currentColor"
                                stroke-width="2" />
                            <path d="M14 2v6h6" stroke="currentColor" stroke-width="2" />
                            <path d="M8 13h8M8 17h8M8 9h2" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" />
                        </svg>
                        导出数据报表
                    </button>
                    <button class="add-row-btn danger-outline" id="clearAllDetail">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6M8 6V4a2 2 0 012-2h4a2 2 0 012 2v2"
                                stroke="currentColor" stroke-width="2" />
                        </svg>
                        清空数据
                    </button>
                </div>
            </section>

            <!-- QR码预览模态框 -->
            <div class="modal" id="qrPreviewModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title">二维码预览</h3>
                        <button class="modal-close" id="closeModal">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                                <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2"
                                    stroke-linecap="round" />
                            </svg>
                        </button>
                    </div>
                    <div class="modal-body">
                        <canvas id="previewCanvas" class="preview-canvas"></canvas>
                        <div class="preview-info">
                            <p class="preview-content-label">包含内容：</p>
                            <p class="preview-content-text" id="previewContent"></p>
                        </div>
                        <div class="preview-actions">
                            <button class="modal-btn primary" id="modalCopy">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                    <rect x="9" y="9" width="13" height="13" rx="2" stroke="currentColor"
                                        stroke-width="2" />
                                    <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1" stroke="currentColor"
                                        stroke-width="2" />
                                </svg>
                                复制
                            </button>
                            <button class="modal-btn" id="modalDownload">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                    <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3"
                                        stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                                </svg>
                                下载
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 确认对话框 -->
            <div class="modal" id="confirmModal">
                <div class="modal-content confirm-dialog">
                    <h3 class="modal-title">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" style="color: #f59e0b;">
                            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                            <path d="M12 8v4M12 16h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        确认操作
                    </h3>
                    <p class="confirm-message" id="confirmMessage"></p>
                    <div class="confirm-actions">
                        <button class="modal-btn" id="confirmCancel">取消</button>
                        <button class="modal-btn danger" id="confirmOk">确定</button>
                    </div>
                </div>
            </div>
        </main>

        <footer class="footer">
            <p>© 2026 送货单 QR Code 生成器 | 支持批量输入与生成</p>
            <p class="contact-info">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="vertical-align: middle;">
                    <rect x="3" y="5" width="18" height="14" rx="2" stroke="currentColor" stroke-width="2" />
                    <path d="M3 7l9 6 9-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                </svg>
                如有疑问或需求更新请联系邮箱：<a href="mailto:SHZhang@wiseally.com.cn">SHZhang@wiseally.com.cn</a>
            </p>
        </footer>
    </div>

    <script src="enhancements.js"></script>
    <script src="script.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(reg => console.log('Service Worker registered'))
                    .catch(err => console.log('Service Worker registration failed: ', err));
            });
        }
    </script>
</body>

</html>