<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="送货单二维码生成器 - 批量生成送货单和送货单明细二维码">
    <title>送货单 QR Code 生成器</title>
    <link rel="stylesheet" href="styles.css">
    <script src="qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>

<body>
    <div class="container">
        <header class="header">
            <div class="logo">
                <svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="3" y="3" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2" />
                    <rect x="14" y="3" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2" />
                    <rect x="3" y="14" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2" />
                    <rect x="14" y="14" width="3" height="3" fill="currentColor" />
                    <rect x="18" y="14" width="3" height="3" fill="currentColor" />
                    <rect x="14" y="18" width="3" height="3" fill="currentColor" />
                    <rect x="18" y="18" width="3" height="3" fill="currentColor" />
                </svg>
            </div>
            <h1>送货单 QR Code 生成器</h1>
            <p class="subtitle">Delivery Note QR Code Generator - 支持批量生成</p>
        </header>

        <!-- 导入功能区域 -->
        <section class="import-section">
            <div class="import-card">
                <div class="import-content">
                    <div class="import-left">
                        <div class="import-header">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6z"
                                    stroke="currentColor" stroke-width="2" />
                                <path d="M14 2v6h6M12 18v-6M9 15l3 3 3-3" stroke="currentColor" stroke-width="2"
                                    stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                            <h3>批量导入数据</h3>
                        </div>
                        <p class="import-desc">下载模板填写数据后，一键导入到页面中批量生成二维码</p>
                        <div class="import-groups">
                            <div class="import-group dn-group">
                                <button class="template-btn" id="downloadDnTemplate">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                                        <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6z"
                                            stroke="currentColor" stroke-width="2" />
                                        <path d="M14 2v6h6" stroke="currentColor" stroke-width="2"
                                            stroke-linecap="round" />
                                    </svg>
                                    下载送货单模板
                                </button>
                                <label class="import-btn">
                                    <input type="file" id="importDnFile" accept=".xlsx,.xls,.csv"
                                        style="display: none;">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                                        <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12"
                                            stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                            stroke-linejoin="round" />
                                    </svg>
                                    导入送货单数据
                                </label>
                            </div>

                            <div class="inner-divider"></div>

                            <div class="import-group detail-group">
                                <button class="template-btn detail-template" id="downloadDetailTemplate">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                                        <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6z"
                                            stroke="currentColor" stroke-width="2" />
                                        <path d="M14 2v6h6" stroke="currentColor" stroke-width="2"
                                            stroke-linecap="round" />
                                    </svg>
                                    下载送货单明细模板
                                </button>
                                <label class="import-btn detail-import">
                                    <input type="file" id="importDetailFile" accept=".xlsx,.xls,.csv"
                                        style="display: none;">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                                        <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12"
                                            stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                            stroke-linejoin="round" />
                                    </svg>
                                    导入送货单明细数据
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="import-right">
                        <h4 class="guide-title">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                                <path d="M12 16v-4M12 8h.01" stroke="currentColor" stroke-width="2"
                                    stroke-linecap="round" />
                            </svg>
                            <span>使用流程 <span class="guide-note-inline">（如只生成单个，不需要参考此流程）</span></span>
                        </h4>
                        <ol class="guide-steps">
                            <li>
                                <span class="step-number">1</span>
                                <span class="step-text">点击"下载送货单模板"或"下载送货单明细模板"</span>
                            </li>
                            <li>
                                <span class="step-number">2</span>
                                <span class="step-text">在Excel中填写数据（可参考模板示例）</span>
                            </li>
                            <li>
                                <span class="step-number">3</span>
                                <span class="step-text">点击"导入送货单数据"或"导入送货单明细数据"</span>
                            </li>
                            <li>
                                <span class="step-number">4</span>
                                <span class="step-text">选择填好的Excel文件，数据自动导入</span>
                            </li>
                            <li>
                                <span class="step-number">5</span>
                                <span class="step-text">点击"批量生成"生成所有二维码</span>
                            </li>
                            <li>
                                <span class="step-number">6</span>
                                <span class="step-text">点击"全部下载"批量保存二维码</span>
                            </li>
                        </ol>
                    </div>
                </div>
            </div>
        </section>

        <main class="main-content">
            <!-- 送货单 QR Code 区域 -->
            <section class="qr-section dn-section">
                <div class="section-header">
                    <div class="section-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                            <rect x="9" y="3" width="6" height="4" rx="1" stroke="currentColor" stroke-width="2" />
                            <path d="M9 12h6M9 16h4" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                    </div>
                    <div>
                        <h2>送货单 QR Code</h2>
                        <p>DN QR Code - 包含3种信息（批量输入）</p>
                    </div>
                </div>

                <div class="table-container">
                    <table class="data-table" id="dnTable">
                        <thead>
                            <tr>
                                <th class="row-num">#</th>
                                <th>DN No. <span class="th-cn">送货单号</span></th>
                                <th>Vendor ID <span class="th-cn">供应商编号</span></th>
                                <th>PO No. <span class="th-cn">采购订单</span></th>
                                <th class="qr-col">QR Code</th>
                                <th class="action-col">操作</th>
                            </tr>
                        </thead>
                        <tbody id="dnTableBody">
                            <tr>
                                <td class="row-num">1</td>
                                <td><input type="text" class="table-input dn-no" placeholder="如DN20250418001"></td>
                                <td><input type="text" class="table-input vendor-id" placeholder="如7016"></td>
                                <td><input type="text" class="table-input po-no" placeholder="如263275"></td>
                                <td class="qr-cell"><canvas class="qr-canvas"></canvas></td>
                                <td class="action-cell">
                                    <button class="btn-icon copy-row" title="复制" disabled>
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                            <rect x="9" y="9" width="13" height="13" rx="2" stroke="currentColor"
                                                stroke-width="2" />
                                            <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"
                                                stroke="currentColor" stroke-width="2" />
                                        </svg>
                                    </button>
                                    <button class="btn-icon download-row" title="下载" disabled>
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                            <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3"
                                                stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                                stroke-linejoin="round" />
                                        </svg>
                                    </button>
                                    <button class="btn-icon delete-row" title="删除行">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2"
                                                stroke-linecap="round" />
                                        </svg>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="table-actions">
                    <button class="add-row-btn" id="addDnRow">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        添加行
                    </button>
                    <button class="generate-btn" id="generateAllDn">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <rect x="3" y="3" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2" />
                            <rect x="14" y="3" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2" />
                            <rect x="3" y="14" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2" />
                            <path d="M14 14h7v7h-7z" stroke="currentColor" stroke-width="2" />
                        </svg>
                        批量生成
                    </button>
                    <button class="download-all-btn" id="downloadAllDn" disabled>
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                        全部下载
                    </button>
                </div>
            </section>

            <!-- 送货单明细 QR Code 区域 -->
            <section class="qr-section detail-section">
                <div class="section-header">
                    <div class="section-icon detail-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6z" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                            <path d="M14 2v6h6M16 13H8M16 17H8M10 9H8" stroke="currentColor" stroke-width="2"
                                stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                    </div>
                    <div>
                        <h2>送货单明细 QR Code</h2>
                        <p>DN Detail QR Code - 包含5种信息（批量输入）</p>
                    </div>
                </div>

                <div class="table-container">
                    <table class="data-table detail-table" id="detailTable">
                        <thead>
                            <tr>
                                <th class="row-num">#</th>
                                <th>Full PO No. <span class="th-cn">完整采购单号</span></th>
                                <th>Qty <span class="th-cn">数量</span></th>
                                <th>Unit <span class="th-cn">单位</span></th>
                                <th>Unique ID <span class="th-cn">流水号</span></th>
                                <th>PN <span class="th-cn">零件编号</span></th>
                                <th class="qr-col">QR Code</th>
                                <th class="action-col">操作</th>
                            </tr>
                        </thead>
                        <tbody id="detailTableBody">
                            <tr>
                                <td class="row-num">1</td>
                                <td><input type="text" class="table-input full-po-no" placeholder="如263275-1-1"></td>
                                <td><input type="text" class="table-input qty" placeholder="如3"></td>
                                <td><input type="text" class="table-input unit" placeholder="如PC"></td>
                                <td><input type="text" class="table-input unique-id" placeholder="如250418003"></td>
                                <td><input type="text" class="table-input pn" placeholder="如MT4571-01-001"></td>
                                <td class="qr-cell"><canvas class="qr-canvas"></canvas></td>
                                <td class="action-cell">
                                    <button class="btn-icon copy-row" title="复制" disabled>
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                            <rect x="9" y="9" width="13" height="13" rx="2" stroke="currentColor"
                                                stroke-width="2" />
                                            <path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"
                                                stroke="currentColor" stroke-width="2" />
                                        </svg>
                                    </button>
                                    <button class="btn-icon download-row" title="下载" disabled>
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                            <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3"
                                                stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                                stroke-linejoin="round" />
                                        </svg>
                                    </button>
                                    <button class="btn-icon delete-row" title="删除行">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                                            <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2"
                                                stroke-linecap="round" />
                                        </svg>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="table-actions">
                    <button class="add-row-btn detail-add" id="addDetailRow">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                        </svg>
                        添加行
                    </button>
                    <button class="generate-btn detail-btn" id="generateAllDetail">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <rect x="3" y="3" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2" />
                            <rect x="14" y="3" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2" />
                            <rect x="3" y="14" width="7" height="7" rx="1" stroke="currentColor" stroke-width="2" />
                            <path d="M14 14h7v7h-7z" stroke="currentColor" stroke-width="2" />
                        </svg>
                        批量生成
                    </button>
                    <button class="download-all-btn detail-download-all" id="downloadAllDetail" disabled>
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                            <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                        </svg>
                        全部下载
                    </button>
                </div>
            </section>
        </main>

        <footer class="footer">
            <p>© 2026 送货单 QR Code 生成器 | 支持批量输入与生成</p>
            <p class="contact-info">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="vertical-align: middle;">
                    <rect x="3" y="5" width="18" height="14" rx="2" stroke="currentColor" stroke-width="2" />
                    <path d="M3 7l9 6 9-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                </svg>
                如有疑问或需求更新请联系邮箱：<a href="mailto:SHZhang@wiseally.com.cn">SHZhang@wiseally.com.cn</a>
            </p>
        </footer>
    </div>

    <script src="script.js"></script>
</body>

</html>